!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1),o=n.n(r);const i="restaurants";class a{static get DATABASE_URL(){return"http://localhost:1337/restaurants/"}static idb(){return o.a.open("app",1,e=>{e.createObjectStore(i,{keyPath:"id"}).createIndex("id","id")})}static saveIdb(e){return a.idb().then(t=>{if(!t)return;const n=t.transaction(i,"readwrite"),r=n.objectStore(i);return e.forEach(e=>{r.put(e)}),n.complete})}static getIdb(){return a.idb().then(e=>{if(!e)return;return e.transaction(i).objectStore(i).getAll()})}static fetchData(){return fetch(a.DATABASE_URL).then(e=>e.json()).then(e=>(a.saveIdb(e),e))}static fetchRestaurants(e){return a.getIdb().then(e=>e.length?Promise.resolve(e):a.fetchData()).then(t=>{e(null,t)}).catch(t=>{e(t,null)})}static fetchRestaurantById(e,t){a.fetchRestaurants((n,r)=>{if(n)t(n,null);else{const n=r.find(t=>t.id==e);n?t(null,n):t("Restaurant does not exist",null)}})}static fetchRestaurantByCuisine(e,t){a.fetchRestaurants((n,r)=>{if(n)t(n,null);else{const n=r.filter(t=>t.cuisine_type==e);t(null,n)}})}static fetchRestaurantByNeighborhood(e,t){a.fetchRestaurants((n,r)=>{if(n)t(n,null);else{const n=r.filter(t=>t.neighborhood==e);t(null,n)}})}static fetchRestaurantByCuisineAndNeighborhood(e,t,n){a.fetchRestaurants((r,o)=>{if(r)n(r,null);else{let r=o;"all"!=e&&(r=r.filter(t=>t.cuisine_type==e)),"all"!=t&&(r=r.filter(e=>e.neighborhood==t)),n(null,r)}})}static fetchNeighborhoods(e){a.fetchRestaurants((t,n)=>{if(t)e(t,null);else{const t=n.map((e,t)=>n[t].neighborhood),r=t.filter((e,n)=>t.indexOf(e)==n);e(null,r)}})}static fetchCuisines(e){a.fetchRestaurants((t,n)=>{if(t)e(t,null);else{const t=n.map((e,t)=>n[t].cuisine_type),r=t.filter((e,n)=>t.indexOf(e)==n);e(null,r)}})}static urlForRestaurant(e){return`./restaurant.html?id=${e.id}`}static imageUrlForRestaurant(e="10",t="/",n=""){return`/dist/img${t}${e}${n}.jpg`}static mapMarkerForRestaurant(e,t){return new google.maps.Marker({position:e.latlng,title:e.name,url:a.urlForRestaurant(e),map:t,animation:google.maps.Animation.DROP})}}},function(e,t,n){"use strict";!function(){function t(e){return new Promise(function(t,n){e.onsuccess=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function n(e,n,r){var o,i=new Promise(function(i,a){t(o=e[n].apply(e,r)).then(i,a)});return i.request=o,i}function r(e,t,n){n.forEach(function(n){Object.defineProperty(e.prototype,n,{get:function(){return this[t][n]},set:function(e){this[t][n]=e}})})}function o(e,t,r,o){o.forEach(function(o){o in r.prototype&&(e.prototype[o]=function(){return n(this[t],o,arguments)})})}function i(e,t,n,r){r.forEach(function(r){r in n.prototype&&(e.prototype[r]=function(){return this[t][r].apply(this[t],arguments)})})}function a(e,t,r,o){o.forEach(function(o){o in r.prototype&&(e.prototype[o]=function(){return e=this[t],(r=n(e,o,arguments)).then(function(e){if(e)return new u(e,r.request)});var e,r})})}function s(e){this._index=e}function u(e,t){this._cursor=e,this._request=t}function c(e){this._store=e}function l(e){this._tx=e,this.complete=new Promise(function(t,n){e.oncomplete=function(){t()},e.onerror=function(){n(e.error)},e.onabort=function(){n(e.error)}})}function d(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new l(n)}function p(e){this._db=e}r(s,"_index",["name","keyPath","multiEntry","unique"]),o(s,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),a(s,"_index",IDBIndex,["openCursor","openKeyCursor"]),r(u,"_cursor",["direction","key","primaryKey","value"]),o(u,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(e){e in IDBCursor.prototype&&(u.prototype[e]=function(){var n=this,r=arguments;return Promise.resolve().then(function(){return n._cursor[e].apply(n._cursor,r),t(n._request).then(function(e){if(e)return new u(e,n._request)})})})}),c.prototype.createIndex=function(){return new s(this._store.createIndex.apply(this._store,arguments))},c.prototype.index=function(){return new s(this._store.index.apply(this._store,arguments))},r(c,"_store",["name","keyPath","indexNames","autoIncrement"]),o(c,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),a(c,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),i(c,"_store",IDBObjectStore,["deleteIndex"]),l.prototype.objectStore=function(){return new c(this._tx.objectStore.apply(this._tx,arguments))},r(l,"_tx",["objectStoreNames","mode"]),i(l,"_tx",IDBTransaction,["abort"]),d.prototype.createObjectStore=function(){return new c(this._db.createObjectStore.apply(this._db,arguments))},r(d,"_db",["name","version","objectStoreNames"]),i(d,"_db",IDBDatabase,["deleteObjectStore","close"]),p.prototype.transaction=function(){return new l(this._db.transaction.apply(this._db,arguments))},r(p,"_db",["name","version","objectStoreNames"]),i(p,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(e){[c,s].forEach(function(t){t.prototype[e.replace("open","iterate")]=function(){var t,n=(t=arguments,Array.prototype.slice.call(t)),r=n[n.length-1],o=this._store||this._index,i=o[e].apply(o,n.slice(0,-1));i.onsuccess=function(){r(i.result)}}})}),[s,c].forEach(function(e){e.prototype.getAll||(e.prototype.getAll=function(e,t){var n=this,r=[];return new Promise(function(o){n.iterateCursor(e,function(e){e?(r.push(e.value),void 0===t||r.length!=t?e.continue():o(r)):o(r)})})})});var f={open:function(e,t,r){var o=n(indexedDB,"open",[e,t]),i=o.request;return i.onupgradeneeded=function(e){r&&r(new d(i.result,e.oldVersion,i.transaction))},o.then(function(e){return new p(e)})},delete:function(e){return n(indexedDB,"deleteDatabase",[e])}};e.exports=f,e.exports.default=e.exports}()},function(e,t,n){"use strict";n.r(t);var r=n(0);const o=[{suffix:"_sm",media:"(max-width: 440px)"},{suffix:"_md",media:"(max-width: 640px),(min-width: 1101px) and (max-width: 1280px)"}];window.initMap=(()=>{i((e,t)=>{e?console.error(e):(self.map=new google.maps.Map(document.getElementById("map"),{zoom:16,center:t.latlng,scrollwheel:!1}),l(),r.a.mapMarkerForRestaurant(self.restaurant,self.map))})});let i=e=>{if(self.restaurant)return void e(null,self.restaurant);const t=d("id");t?r.a.fetchRestaurantById(t,(t,n)=>{self.restaurant=n,n?(a(),e(null,n)):console.error(t)}):(error="No restaurant id in URL",e(error,null))},a=(e=self.restaurant)=>{document.getElementById("restaurant-name").innerHTML=e.name,document.getElementById("restaurant-address").innerHTML=e.address;const t=document.getElementById("restaurant-img");t.className="restaurant-img",t.src=r.a.imageUrlForRestaurant(e.photograph),t.alt=`Image of ${e.name} Restaurant`;const n=document.getElementById("restaurant-picture"),i=[];o.forEach(t=>{const n=document.createElement("source");n.srcset=r.a.imageUrlForRestaurant(e.photograph,"/responsive/",t.suffix),n.media=t.media,i.push(n)}),i.forEach(e=>{n.insertBefore(e,t)}),document.getElementById("restaurant-cuisine").innerHTML=e.cuisine_type,e.operating_hours&&s(),u()},s=(e=self.restaurant.operating_hours)=>{const t=document.getElementById("restaurant-hours");for(let n in e){const r=document.createElement("tr"),o=document.createElement("td");o.innerHTML=n,o.setAttribute("aria-label","Open "+n),r.appendChild(o);const i=document.createElement("td");i.innerHTML=e[n],i.setAttribute("aria-label","Opening hours "+e[n]),r.appendChild(i),t.appendChild(r)}},u=(e=self.restaurant.reviews)=>{const t=document.getElementById("reviews-container"),n=document.createElement("h3");if(n.innerHTML="Reviews",t.appendChild(n),!e){const e=document.createElement("p");return e.innerHTML="No reviews yet!",void t.appendChild(e)}const r=document.getElementById("reviews-list");e.forEach((t,n)=>{r.appendChild(c(t,e.length,n))}),t.appendChild(r)},c=(e,t,n)=>{const r=document.createElement("li");r.setAttribute("aria-setsize",t),r.setAttribute("aria-posinset",(Number(n)+1).toString());const o=document.createElement("p");o.innerHTML=e.name,r.appendChild(o);const i=document.createElement("p");i.innerHTML=e.date,r.appendChild(i);const a=document.createElement("p");a.innerHTML=`Rating: ${e.rating}`,r.appendChild(a);const s=document.createElement("p");return s.innerHTML=e.comments,r.appendChild(s),r},l=(e=self.restaurant)=>{const t=document.getElementById("breadcrumb"),n=document.createElement("li");n.innerHTML=e.name,n.setAttribute("aria-current","page"),t.appendChild(n)},d=(e,t)=>{t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");const n=new RegExp(`[?&]${e}(=([^&#]*)|&|#|$)`).exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}},function(e,t,n){e.exports=n(2)}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vanMvZGJoZWxwZXIuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL2lkYi9saWIvaWRiLmpzIiwid2VicGFjazovLy8uL2pzL3Jlc3RhdXJhbnRfaW5mby5qcyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiY29uZmlndXJhYmxlIiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJ2YWx1ZSIsIm4iLCJfX2VzTW9kdWxlIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiaWRiTmFtZSIsIkRCSGVscGVyIiwiREFUQUJBU0VfVVJMIiwiW29iamVjdCBPYmplY3RdIiwiaWRiX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX19fZGVmYXVsdCIsImEiLCJvcGVuIiwidXBncmFkZURiIiwiY3JlYXRlT2JqZWN0U3RvcmUiLCJrZXlQYXRoIiwiY3JlYXRlSW5kZXgiLCJkYXRhIiwiaWRiIiwidGhlbiIsImRiIiwidHgiLCJ0cmFuc2FjdGlvbiIsInN0b3JlIiwib2JqZWN0U3RvcmUiLCJmb3JFYWNoIiwicmVzdGF1cmFudCIsInB1dCIsImNvbXBsZXRlIiwiZ2V0QWxsIiwiZmV0Y2giLCJyZXNwb25zZSIsImpzb24iLCJyZXN0YXVyYW50cyIsInNhdmVJZGIiLCJjYWxsYmFjayIsImdldElkYiIsImxlbmd0aCIsIlByb21pc2UiLCJyZXNvbHZlIiwiZmV0Y2hEYXRhIiwiY2F0Y2giLCJlcnJvciIsImlkIiwiZmV0Y2hSZXN0YXVyYW50cyIsImZpbmQiLCJjdWlzaW5lIiwicmVzdWx0cyIsImZpbHRlciIsImN1aXNpbmVfdHlwZSIsIm5laWdoYm9yaG9vZCIsIm5laWdoYm9yaG9vZHMiLCJtYXAiLCJ2IiwidW5pcXVlTmVpZ2hib3Job29kcyIsImluZGV4T2YiLCJjdWlzaW5lcyIsInVuaXF1ZUN1aXNpbmVzIiwicGhvdG8iLCJkaXIiLCJzdWZmaXgiLCJnb29nbGUiLCJtYXBzIiwiTWFya2VyIiwicG9zaXRpb24iLCJsYXRsbmciLCJ0aXRsZSIsInVybCIsInVybEZvclJlc3RhdXJhbnQiLCJhbmltYXRpb24iLCJBbmltYXRpb24iLCJEUk9QIiwicHJvbWlzaWZ5UmVxdWVzdCIsInJlcXVlc3QiLCJyZWplY3QiLCJvbnN1Y2Nlc3MiLCJyZXN1bHQiLCJvbmVycm9yIiwicHJvbWlzaWZ5UmVxdWVzdENhbGwiLCJvYmoiLCJtZXRob2QiLCJhcmdzIiwiYXBwbHkiLCJwcm94eVByb3BlcnRpZXMiLCJQcm94eUNsYXNzIiwidGFyZ2V0UHJvcCIsInByb3BlcnRpZXMiLCJwcm9wIiwidGhpcyIsInNldCIsInZhbCIsInByb3h5UmVxdWVzdE1ldGhvZHMiLCJDb25zdHJ1Y3RvciIsImFyZ3VtZW50cyIsInByb3h5TWV0aG9kcyIsInByb3h5Q3Vyc29yUmVxdWVzdE1ldGhvZHMiLCJDdXJzb3IiLCJJbmRleCIsImluZGV4IiwiX2luZGV4IiwiY3Vyc29yIiwiX2N1cnNvciIsIl9yZXF1ZXN0IiwiT2JqZWN0U3RvcmUiLCJfc3RvcmUiLCJUcmFuc2FjdGlvbiIsImlkYlRyYW5zYWN0aW9uIiwiX3R4Iiwib25jb21wbGV0ZSIsIm9uYWJvcnQiLCJVcGdyYWRlREIiLCJvbGRWZXJzaW9uIiwiX2RiIiwiREIiLCJJREJJbmRleCIsIklEQkN1cnNvciIsIm1ldGhvZE5hbWUiLCJJREJPYmplY3RTdG9yZSIsIklEQlRyYW5zYWN0aW9uIiwiSURCRGF0YWJhc2UiLCJmdW5jTmFtZSIsInJlcGxhY2UiLCJhcnIiLCJBcnJheSIsInNsaWNlIiwibmF0aXZlT2JqZWN0IiwicXVlcnkiLCJjb3VudCIsImluc3RhbmNlIiwiaXRlbXMiLCJpdGVyYXRlQ3Vyc29yIiwicHVzaCIsInVuZGVmaW5lZCIsImNvbnRpbnVlIiwiZXhwIiwidmVyc2lvbiIsInVwZ3JhZGVDYWxsYmFjayIsImluZGV4ZWREQiIsIm9udXBncmFkZW5lZWRlZCIsImV2ZW50IiwiZGVsZXRlIiwiZGVmYXVsdCIsImltYWdlU291cmNlcyIsIm1lZGlhIiwid2luZG93IiwiaW5pdE1hcCIsImZldGNoUmVzdGF1cmFudEZyb21VUkwiLCJjb25zb2xlIiwic2VsZiIsIk1hcCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJ6b29tIiwiY2VudGVyIiwic2Nyb2xsd2hlZWwiLCJmaWxsQnJlYWRjcnVtYiIsIl9kYmhlbHBlcl9qc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fIiwibWFwTWFya2VyRm9yUmVzdGF1cmFudCIsImdldFBhcmFtZXRlckJ5TmFtZSIsImZldGNoUmVzdGF1cmFudEJ5SWQiLCJmaWxsUmVzdGF1cmFudEhUTUwiLCJpbm5lckhUTUwiLCJhZGRyZXNzIiwiaW1hZ2UiLCJjbGFzc05hbWUiLCJzcmMiLCJpbWFnZVVybEZvclJlc3RhdXJhbnQiLCJwaG90b2dyYXBoIiwiYWx0IiwicGljdHVyZSIsInNvdXJjZXMiLCJpbWFnZVNvdXJjZSIsInNvdXJjZSIsImNyZWF0ZUVsZW1lbnQiLCJzcmNzZXQiLCJpbnNlcnRCZWZvcmUiLCJvcGVyYXRpbmdfaG91cnMiLCJmaWxsUmVzdGF1cmFudEhvdXJzSFRNTCIsImZpbGxSZXZpZXdzSFRNTCIsIm9wZXJhdGluZ0hvdXJzIiwiaG91cnMiLCJrZXkiLCJyb3ciLCJkYXkiLCJzZXRBdHRyaWJ1dGUiLCJhcHBlbmRDaGlsZCIsInRpbWUiLCJyZXZpZXdzIiwiY29udGFpbmVyIiwibm9SZXZpZXdzIiwidWwiLCJyZXZpZXciLCJjcmVhdGVSZXZpZXdIVE1MIiwibGkiLCJOdW1iZXIiLCJ0b1N0cmluZyIsImRhdGUiLCJyYXRpbmciLCJjb21tZW50cyIsImJyZWFkY3J1bWIi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QUFILFlBQUFLLElBTUFFLEVBQUEsQ0FBQUQsRUFBQTFKLEVBQUE2RCxLQUNBLE1BQUErRixFQUFBM0MsU0FBQXVCLGNBQUEsTUFDQW9CLEVBQUFULGFBQUEsZUFBQW5KLEdBQ0E0SixFQUFBVCxhQUFBLGlCQUFBVSxPQUFBaEcsR0FBQSxHQUFBaUcsWUFDQSxNQUFBL00sRUFBQWtLLFNBQUF1QixjQUFBLEtBQ0F6TCxFQUFBNkssVUFBQThCLEVBQUEzTSxLQUNBNk0sRUFBQVIsWUFBQXJNLEdBRUEsTUFBQWdOLEVBQUE5QyxTQUFBdUIsY0FBQSxLQUNBdUIsRUFBQW5DLFVBQUE4QixFQUFBSyxLQUNBSCxFQUFBUixZQUFBVyxHQUVBLE1BQUFDLEVBQUEvQyxTQUFBdUIsY0FBQSxLQUNBd0IsRUFBQXBDLHFCQUFrQzhCLEVBQUFNLFNBQ2xDSixFQUFBUixZQUFBWSxHQUVBLE1BQUFDLEVBQUFoRCxTQUFBdUIsY0FBQSxLQUlBLE9BSEF5QixFQUFBckMsVUFBQThCLEVBQUFPLFNBQ0FMLEVBQUFSLFlBQUFhLEdBRUFMLEdBTUF0QyxFQUFBLENBQUFqSSxFQUFBMEgsS0FBQTFILGNBQ0EsTUFBQTZLLEVBQUFqRCxTQUFBQyxlQUFBLGNBQ0EwQyxFQUFBM0MsU0FBQXVCLGNBQUEsTUFDQW9CLEVBQUFoQyxVQUFBdkksRUFBQXRDLEtBQ0E2TSxFQUFBVCxhQUFBLHVCQUNBZSxFQUFBZCxZQUFBUSxJQU1BbkMsRUFBQSxDQUFBMUssRUFBQStFLEtBQ0FBLElBQ0FBLEVBQUE2RSxPQUFBd0QsU0FBQUMsTUFDQXJOLElBQUFxSSxRQUFBLGtCQUNBLE1BQ0ExRSxFQURBLElBQUEySixjQUFvQ3ROLHNCQUNwQ3VOLEtBQUF4SSxHQUNBLE9BQUFwQixFQUVBQSxFQUFBLEdBRUE2SixtQkFBQTdKLEVBQUEsR0FBQTBFLFFBQUEsWUFEQSxHQUZBIiwiZmlsZSI6InJlc3RhdXJhbnQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHtcbiBcdFx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gXHRcdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuIFx0XHRcdFx0Z2V0OiBnZXR0ZXJcbiBcdFx0XHR9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDMpO1xuIiwiaW1wb3J0IGlkYiBmcm9tICdpZGInO1xyXG5cclxuY29uc3QgaWRiTmFtZSA9ICdyZXN0YXVyYW50cyc7XHJcblxyXG4vKipcclxuICogQ29tbW9uIGRhdGFiYXNlIGhlbHBlciBmdW5jdGlvbnMuXHJcbiAqL1xyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEQkhlbHBlciB7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBEYXRhYmFzZSBVUkwuXHJcbiAgICAgKiBDaGFuZ2UgdGhpcyB0byByZXN0YXVyYW50cy5qc29uIGZpbGUgbG9jYXRpb24gb24geW91ciBzZXJ2ZXIuXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBnZXQgREFUQUJBU0VfVVJMKCkge1xyXG4gICAgICAgIGNvbnN0IHBvcnQgPSAxMzM3OyAvLyBDaGFuZ2UgdGhpcyB0byB5b3VyIHNlcnZlciBwb3J0XHJcbiAgICAgICAgcmV0dXJuIGBodHRwOi8vbG9jYWxob3N0OiR7cG9ydH0vcmVzdGF1cmFudHMvYDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICogT3BlbiBpZGJcclxuICAgICovXHJcblxyXG4gICAgc3RhdGljIGlkYigpIHtcclxuICAgICAgICByZXR1cm4gaWRiLm9wZW4oJ2FwcCcsIDEsICh1cGdyYWRlRGIpID0+IHtcclxuICAgICAgICAgICAgY29uc3Qgc3RvcmUgPSB1cGdyYWRlRGIuY3JlYXRlT2JqZWN0U3RvcmUoaWRiTmFtZSwge2tleVBhdGg6ICdpZCd9KTtcclxuICAgICAgICAgICAgc3RvcmUuY3JlYXRlSW5kZXgoJ2lkJywgJ2lkJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTYXZlIGlkYlxyXG4gICAgICovXHJcblxyXG4gICAgc3RhdGljIHNhdmVJZGIoZGF0YSkge1xyXG4gICAgICAgIHJldHVybiBEQkhlbHBlci5pZGIoKS50aGVuKGRiID0+IHtcclxuICAgICAgICAgICAgaWYgKCFkYikgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgdHggPSBkYi50cmFuc2FjdGlvbihpZGJOYW1lLCAncmVhZHdyaXRlJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IHN0b3JlID0gdHgub2JqZWN0U3RvcmUoaWRiTmFtZSk7XHJcbiAgICAgICAgICAgIGRhdGEuZm9yRWFjaChyZXN0YXVyYW50ID0+IHtcclxuICAgICAgICAgICAgICAgIHN0b3JlLnB1dChyZXN0YXVyYW50KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiB0eC5jb21wbGV0ZTtcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0IGlkYlxyXG4gICAgICovXHJcblxyXG4gICAgc3RhdGljIGdldElkYigpIHtcclxuICAgICAgICByZXR1cm4gREJIZWxwZXIuaWRiKCkudGhlbihkYiA9PiB7XHJcbiAgICAgICAgICAgIGlmICghZGIpIHJldHVybjtcclxuICAgICAgICAgICAgY29uc3Qgc3RvcmUgPSBkYi50cmFuc2FjdGlvbihpZGJOYW1lKS5vYmplY3RTdG9yZShpZGJOYW1lKTtcclxuICAgICAgICAgICAgcmV0dXJuIHN0b3JlLmdldEFsbCgpO1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBGZXRjaCByZXN0YXVyYW50cyB0byBpZGJcclxuICAgICAqL1xyXG5cclxuICAgIHN0YXRpYyBmZXRjaERhdGEoKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKERCSGVscGVyLkRBVEFCQVNFX1VSTClcclxuICAgICAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gcmVzcG9uc2UuanNvbigpKVxyXG4gICAgICAgICAgICAudGhlbihyZXN0YXVyYW50cyA9PiB7XHJcbiAgICAgICAgICAgICAgICBEQkhlbHBlci5zYXZlSWRiKHJlc3RhdXJhbnRzKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXN0YXVyYW50cztcclxuICAgICAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEZldGNoIGFsbCByZXN0YXVyYW50cy5cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGZldGNoUmVzdGF1cmFudHMoY2FsbGJhY2spIHtcclxuICAgICAgICByZXR1cm4gREJIZWxwZXIuZ2V0SWRiKCkudGhlbihyZXN0YXVyYW50cyA9PiB7XHJcbiAgICAgICAgICAgIGlmIChyZXN0YXVyYW50cy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUocmVzdGF1cmFudHMpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIERCSGVscGVyLmZldGNoRGF0YSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSkudGhlbihyZXN0YXVyYW50cyA9PiB7XHJcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3RhdXJhbnRzKTtcclxuICAgICAgICB9KS5jYXRjaChlcnJvciA9PiB7XHJcbiAgICAgICAgICAgIGNhbGxiYWNrKGVycm9yLCBudWxsKTtcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRmV0Y2ggYSByZXN0YXVyYW50IGJ5IGl0cyBJRC5cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGZldGNoUmVzdGF1cmFudEJ5SWQoaWQsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgLy8gZmV0Y2ggYWxsIHJlc3RhdXJhbnRzIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxyXG4gICAgICAgIERCSGVscGVyLmZldGNoUmVzdGF1cmFudHMoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKGVycm9yLCBudWxsKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3RhdXJhbnQgPSByZXN0YXVyYW50cy5maW5kKHIgPT4gci5pZCA9PSBpZCk7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzdGF1cmFudCkgeyAvLyBHb3QgdGhlIHJlc3RhdXJhbnRcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhudWxsLCByZXN0YXVyYW50KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7IC8vIFJlc3RhdXJhbnQgZG9lcyBub3QgZXhpc3QgaW4gdGhlIGRhdGFiYXNlXHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soJ1Jlc3RhdXJhbnQgZG9lcyBub3QgZXhpc3QnLCBudWxsKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRmV0Y2ggcmVzdGF1cmFudHMgYnkgYSBjdWlzaW5lIHR5cGUgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBmZXRjaFJlc3RhdXJhbnRCeUN1aXNpbmUoY3Vpc2luZSwgY2FsbGJhY2spIHtcclxuICAgICAgICAvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHMgIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nXHJcbiAgICAgICAgREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50cygoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gRmlsdGVyIHJlc3RhdXJhbnRzIHRvIGhhdmUgb25seSBnaXZlbiBjdWlzaW5lIHR5cGVcclxuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdHMgPSByZXN0YXVyYW50cy5maWx0ZXIociA9PiByLmN1aXNpbmVfdHlwZSA9PSBjdWlzaW5lKTtcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3VsdHMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBGZXRjaCByZXN0YXVyYW50cyBieSBhIG5laWdoYm9yaG9vZCB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGZldGNoUmVzdGF1cmFudEJ5TmVpZ2hib3Job29kKG5laWdoYm9yaG9vZCwgY2FsbGJhY2spIHtcclxuICAgICAgICAvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHNcclxuICAgICAgICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRzKChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcclxuICAgICAgICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhlcnJvciwgbnVsbCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBGaWx0ZXIgcmVzdGF1cmFudHMgdG8gaGF2ZSBvbmx5IGdpdmVuIG5laWdoYm9yaG9vZFxyXG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0cyA9IHJlc3RhdXJhbnRzLmZpbHRlcihyID0+IHIubmVpZ2hib3Job29kID09IG5laWdoYm9yaG9vZCk7XHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhudWxsLCByZXN1bHRzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRmV0Y2ggcmVzdGF1cmFudHMgYnkgYSBjdWlzaW5lIGFuZCBhIG5laWdoYm9yaG9vZCB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGZldGNoUmVzdGF1cmFudEJ5Q3Vpc2luZUFuZE5laWdoYm9yaG9vZChjdWlzaW5lLCBuZWlnaGJvcmhvb2QsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgLy8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXHJcbiAgICAgICAgREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50cygoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbGV0IHJlc3VsdHMgPSByZXN0YXVyYW50c1xyXG4gICAgICAgICAgICAgICAgaWYgKGN1aXNpbmUgIT0gJ2FsbCcpIHsgLy8gZmlsdGVyIGJ5IGN1aXNpbmVcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHRzID0gcmVzdWx0cy5maWx0ZXIociA9PiByLmN1aXNpbmVfdHlwZSA9PSBjdWlzaW5lKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChuZWlnaGJvcmhvb2QgIT0gJ2FsbCcpIHsgLy8gZmlsdGVyIGJ5IG5laWdoYm9yaG9vZFxyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdHMgPSByZXN1bHRzLmZpbHRlcihyID0+IHIubmVpZ2hib3Job29kID09IG5laWdoYm9yaG9vZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhudWxsLCByZXN1bHRzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRmV0Y2ggYWxsIG5laWdoYm9yaG9vZHMgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBmZXRjaE5laWdoYm9yaG9vZHMoY2FsbGJhY2spIHtcclxuICAgICAgICAvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHNcclxuICAgICAgICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRzKChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcclxuICAgICAgICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhlcnJvciwgbnVsbCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBHZXQgYWxsIG5laWdoYm9yaG9vZHMgZnJvbSBhbGwgcmVzdGF1cmFudHNcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5laWdoYm9yaG9vZHMgPSByZXN0YXVyYW50cy5tYXAoKHYsIGkpID0+IHJlc3RhdXJhbnRzW2ldLm5laWdoYm9yaG9vZClcclxuICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBkdXBsaWNhdGVzIGZyb20gbmVpZ2hib3Job29kc1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdW5pcXVlTmVpZ2hib3Job29kcyA9IG5laWdoYm9yaG9vZHMuZmlsdGVyKCh2LCBpKSA9PiBuZWlnaGJvcmhvb2RzLmluZGV4T2YodikgPT0gaSlcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIHVuaXF1ZU5laWdoYm9yaG9vZHMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBGZXRjaCBhbGwgY3Vpc2luZXMgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBmZXRjaEN1aXNpbmVzKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgLy8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXHJcbiAgICAgICAgREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50cygoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gR2V0IGFsbCBjdWlzaW5lcyBmcm9tIGFsbCByZXN0YXVyYW50c1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY3Vpc2luZXMgPSByZXN0YXVyYW50cy5tYXAoKHYsIGkpID0+IHJlc3RhdXJhbnRzW2ldLmN1aXNpbmVfdHlwZSlcclxuICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBkdXBsaWNhdGVzIGZyb20gY3Vpc2luZXNcclxuICAgICAgICAgICAgICAgIGNvbnN0IHVuaXF1ZUN1aXNpbmVzID0gY3Vpc2luZXMuZmlsdGVyKCh2LCBpKSA9PiBjdWlzaW5lcy5pbmRleE9mKHYpID09IGkpXHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhudWxsLCB1bmlxdWVDdWlzaW5lcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJlc3RhdXJhbnQgcGFnZSBVUkwuXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyB1cmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpIHtcclxuICAgICAgICByZXR1cm4gKGAuL3Jlc3RhdXJhbnQuaHRtbD9pZD0ke3Jlc3RhdXJhbnQuaWR9YCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXN0YXVyYW50IGltYWdlIFVSTC5cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGltYWdlVXJsRm9yUmVzdGF1cmFudChwaG90bz0nMTAnLCBkaXIgPSAnLycsIHN1ZmZpeCA9ICcnKSB7XHJcbiAgICAgICAgcmV0dXJuIChgL2Rpc3QvaW1nJHtkaXJ9JHtwaG90b30ke3N1ZmZpeH0uanBnYCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBNYXAgbWFya2VyIGZvciBhIHJlc3RhdXJhbnQuXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBtYXBNYXJrZXJGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQsIG1hcCkge1xyXG4gICAgICAgIGNvbnN0IG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xyXG4gICAgICAgICAgICAgICAgcG9zaXRpb246IHJlc3RhdXJhbnQubGF0bG5nLFxyXG4gICAgICAgICAgICAgICAgdGl0bGU6IHJlc3RhdXJhbnQubmFtZSxcclxuICAgICAgICAgICAgICAgIHVybDogREJIZWxwZXIudXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KSxcclxuICAgICAgICAgICAgICAgIG1hcDogbWFwLFxyXG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uOiBnb29nbGUubWFwcy5BbmltYXRpb24uRFJPUFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgKTtcclxuICAgICAgICByZXR1cm4gbWFya2VyO1xyXG4gICAgfVxyXG5cclxufVxyXG4iLCIndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbigpIHtcbiAgZnVuY3Rpb24gdG9BcnJheShhcnIpIHtcbiAgICByZXR1cm4gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJyKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHByb21pc2lmeVJlcXVlc3QocmVxdWVzdCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIHJlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJlc29sdmUocmVxdWVzdC5yZXN1bHQpO1xuICAgICAgfTtcblxuICAgICAgcmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJlamVjdChyZXF1ZXN0LmVycm9yKTtcbiAgICAgIH07XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBwcm9taXNpZnlSZXF1ZXN0Q2FsbChvYmosIG1ldGhvZCwgYXJncykge1xuICAgIHZhciByZXF1ZXN0O1xuICAgIHZhciBwID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICByZXF1ZXN0ID0gb2JqW21ldGhvZF0uYXBwbHkob2JqLCBhcmdzKTtcbiAgICAgIHByb21pc2lmeVJlcXVlc3QocmVxdWVzdCkudGhlbihyZXNvbHZlLCByZWplY3QpO1xuICAgIH0pO1xuXG4gICAgcC5yZXF1ZXN0ID0gcmVxdWVzdDtcbiAgICByZXR1cm4gcDtcbiAgfVxuXG4gIGZ1bmN0aW9uIHByb21pc2lmeUN1cnNvclJlcXVlc3RDYWxsKG9iaiwgbWV0aG9kLCBhcmdzKSB7XG4gICAgdmFyIHAgPSBwcm9taXNpZnlSZXF1ZXN0Q2FsbChvYmosIG1ldGhvZCwgYXJncyk7XG4gICAgcmV0dXJuIHAudGhlbihmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgaWYgKCF2YWx1ZSkgcmV0dXJuO1xuICAgICAgcmV0dXJuIG5ldyBDdXJzb3IodmFsdWUsIHAucmVxdWVzdCk7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBwcm94eVByb3BlcnRpZXMoUHJveHlDbGFzcywgdGFyZ2V0UHJvcCwgcHJvcGVydGllcykge1xuICAgIHByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbihwcm9wKSB7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUHJveHlDbGFzcy5wcm90b3R5cGUsIHByb3AsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdGhpc1t0YXJnZXRQcm9wXVtwcm9wXTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbih2YWwpIHtcbiAgICAgICAgICB0aGlzW3RhcmdldFByb3BdW3Byb3BdID0gdmFsO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHByb3h5UmVxdWVzdE1ldGhvZHMoUHJveHlDbGFzcywgdGFyZ2V0UHJvcCwgQ29uc3RydWN0b3IsIHByb3BlcnRpZXMpIHtcbiAgICBwcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24ocHJvcCkge1xuICAgICAgaWYgKCEocHJvcCBpbiBDb25zdHJ1Y3Rvci5wcm90b3R5cGUpKSByZXR1cm47XG4gICAgICBQcm94eUNsYXNzLnByb3RvdHlwZVtwcm9wXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gcHJvbWlzaWZ5UmVxdWVzdENhbGwodGhpc1t0YXJnZXRQcm9wXSwgcHJvcCwgYXJndW1lbnRzKTtcbiAgICAgIH07XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBwcm94eU1ldGhvZHMoUHJveHlDbGFzcywgdGFyZ2V0UHJvcCwgQ29uc3RydWN0b3IsIHByb3BlcnRpZXMpIHtcbiAgICBwcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24ocHJvcCkge1xuICAgICAgaWYgKCEocHJvcCBpbiBDb25zdHJ1Y3Rvci5wcm90b3R5cGUpKSByZXR1cm47XG4gICAgICBQcm94eUNsYXNzLnByb3RvdHlwZVtwcm9wXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpc1t0YXJnZXRQcm9wXVtwcm9wXS5hcHBseSh0aGlzW3RhcmdldFByb3BdLCBhcmd1bWVudHMpO1xuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHByb3h5Q3Vyc29yUmVxdWVzdE1ldGhvZHMoUHJveHlDbGFzcywgdGFyZ2V0UHJvcCwgQ29uc3RydWN0b3IsIHByb3BlcnRpZXMpIHtcbiAgICBwcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24ocHJvcCkge1xuICAgICAgaWYgKCEocHJvcCBpbiBDb25zdHJ1Y3Rvci5wcm90b3R5cGUpKSByZXR1cm47XG4gICAgICBQcm94eUNsYXNzLnByb3RvdHlwZVtwcm9wXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gcHJvbWlzaWZ5Q3Vyc29yUmVxdWVzdENhbGwodGhpc1t0YXJnZXRQcm9wXSwgcHJvcCwgYXJndW1lbnRzKTtcbiAgICAgIH07XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBJbmRleChpbmRleCkge1xuICAgIHRoaXMuX2luZGV4ID0gaW5kZXg7XG4gIH1cblxuICBwcm94eVByb3BlcnRpZXMoSW5kZXgsICdfaW5kZXgnLCBbXG4gICAgJ25hbWUnLFxuICAgICdrZXlQYXRoJyxcbiAgICAnbXVsdGlFbnRyeScsXG4gICAgJ3VuaXF1ZSdcbiAgXSk7XG5cbiAgcHJveHlSZXF1ZXN0TWV0aG9kcyhJbmRleCwgJ19pbmRleCcsIElEQkluZGV4LCBbXG4gICAgJ2dldCcsXG4gICAgJ2dldEtleScsXG4gICAgJ2dldEFsbCcsXG4gICAgJ2dldEFsbEtleXMnLFxuICAgICdjb3VudCdcbiAgXSk7XG5cbiAgcHJveHlDdXJzb3JSZXF1ZXN0TWV0aG9kcyhJbmRleCwgJ19pbmRleCcsIElEQkluZGV4LCBbXG4gICAgJ29wZW5DdXJzb3InLFxuICAgICdvcGVuS2V5Q3Vyc29yJ1xuICBdKTtcblxuICBmdW5jdGlvbiBDdXJzb3IoY3Vyc29yLCByZXF1ZXN0KSB7XG4gICAgdGhpcy5fY3Vyc29yID0gY3Vyc29yO1xuICAgIHRoaXMuX3JlcXVlc3QgPSByZXF1ZXN0O1xuICB9XG5cbiAgcHJveHlQcm9wZXJ0aWVzKEN1cnNvciwgJ19jdXJzb3InLCBbXG4gICAgJ2RpcmVjdGlvbicsXG4gICAgJ2tleScsXG4gICAgJ3ByaW1hcnlLZXknLFxuICAgICd2YWx1ZSdcbiAgXSk7XG5cbiAgcHJveHlSZXF1ZXN0TWV0aG9kcyhDdXJzb3IsICdfY3Vyc29yJywgSURCQ3Vyc29yLCBbXG4gICAgJ3VwZGF0ZScsXG4gICAgJ2RlbGV0ZSdcbiAgXSk7XG5cbiAgLy8gcHJveHkgJ25leHQnIG1ldGhvZHNcbiAgWydhZHZhbmNlJywgJ2NvbnRpbnVlJywgJ2NvbnRpbnVlUHJpbWFyeUtleSddLmZvckVhY2goZnVuY3Rpb24obWV0aG9kTmFtZSkge1xuICAgIGlmICghKG1ldGhvZE5hbWUgaW4gSURCQ3Vyc29yLnByb3RvdHlwZSkpIHJldHVybjtcbiAgICBDdXJzb3IucHJvdG90eXBlW21ldGhvZE5hbWVdID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgY3Vyc29yID0gdGhpcztcbiAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzO1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgIGN1cnNvci5fY3Vyc29yW21ldGhvZE5hbWVdLmFwcGx5KGN1cnNvci5fY3Vyc29yLCBhcmdzKTtcbiAgICAgICAgcmV0dXJuIHByb21pc2lmeVJlcXVlc3QoY3Vyc29yLl9yZXF1ZXN0KS50aGVuKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgaWYgKCF2YWx1ZSkgcmV0dXJuO1xuICAgICAgICAgIHJldHVybiBuZXcgQ3Vyc29yKHZhbHVlLCBjdXJzb3IuX3JlcXVlc3QpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH07XG4gIH0pO1xuXG4gIGZ1bmN0aW9uIE9iamVjdFN0b3JlKHN0b3JlKSB7XG4gICAgdGhpcy5fc3RvcmUgPSBzdG9yZTtcbiAgfVxuXG4gIE9iamVjdFN0b3JlLnByb3RvdHlwZS5jcmVhdGVJbmRleCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBuZXcgSW5kZXgodGhpcy5fc3RvcmUuY3JlYXRlSW5kZXguYXBwbHkodGhpcy5fc3RvcmUsIGFyZ3VtZW50cykpO1xuICB9O1xuXG4gIE9iamVjdFN0b3JlLnByb3RvdHlwZS5pbmRleCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBuZXcgSW5kZXgodGhpcy5fc3RvcmUuaW5kZXguYXBwbHkodGhpcy5fc3RvcmUsIGFyZ3VtZW50cykpO1xuICB9O1xuXG4gIHByb3h5UHJvcGVydGllcyhPYmplY3RTdG9yZSwgJ19zdG9yZScsIFtcbiAgICAnbmFtZScsXG4gICAgJ2tleVBhdGgnLFxuICAgICdpbmRleE5hbWVzJyxcbiAgICAnYXV0b0luY3JlbWVudCdcbiAgXSk7XG5cbiAgcHJveHlSZXF1ZXN0TWV0aG9kcyhPYmplY3RTdG9yZSwgJ19zdG9yZScsIElEQk9iamVjdFN0b3JlLCBbXG4gICAgJ3B1dCcsXG4gICAgJ2FkZCcsXG4gICAgJ2RlbGV0ZScsXG4gICAgJ2NsZWFyJyxcbiAgICAnZ2V0JyxcbiAgICAnZ2V0QWxsJyxcbiAgICAnZ2V0S2V5JyxcbiAgICAnZ2V0QWxsS2V5cycsXG4gICAgJ2NvdW50J1xuICBdKTtcblxuICBwcm94eUN1cnNvclJlcXVlc3RNZXRob2RzKE9iamVjdFN0b3JlLCAnX3N0b3JlJywgSURCT2JqZWN0U3RvcmUsIFtcbiAgICAnb3BlbkN1cnNvcicsXG4gICAgJ29wZW5LZXlDdXJzb3InXG4gIF0pO1xuXG4gIHByb3h5TWV0aG9kcyhPYmplY3RTdG9yZSwgJ19zdG9yZScsIElEQk9iamVjdFN0b3JlLCBbXG4gICAgJ2RlbGV0ZUluZGV4J1xuICBdKTtcblxuICBmdW5jdGlvbiBUcmFuc2FjdGlvbihpZGJUcmFuc2FjdGlvbikge1xuICAgIHRoaXMuX3R4ID0gaWRiVHJhbnNhY3Rpb247XG4gICAgdGhpcy5jb21wbGV0ZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgaWRiVHJhbnNhY3Rpb24ub25jb21wbGV0ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXNvbHZlKCk7XG4gICAgICB9O1xuICAgICAgaWRiVHJhbnNhY3Rpb24ub25lcnJvciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZWplY3QoaWRiVHJhbnNhY3Rpb24uZXJyb3IpO1xuICAgICAgfTtcbiAgICAgIGlkYlRyYW5zYWN0aW9uLm9uYWJvcnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmVqZWN0KGlkYlRyYW5zYWN0aW9uLmVycm9yKTtcbiAgICAgIH07XG4gICAgfSk7XG4gIH1cblxuICBUcmFuc2FjdGlvbi5wcm90b3R5cGUub2JqZWN0U3RvcmUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbmV3IE9iamVjdFN0b3JlKHRoaXMuX3R4Lm9iamVjdFN0b3JlLmFwcGx5KHRoaXMuX3R4LCBhcmd1bWVudHMpKTtcbiAgfTtcblxuICBwcm94eVByb3BlcnRpZXMoVHJhbnNhY3Rpb24sICdfdHgnLCBbXG4gICAgJ29iamVjdFN0b3JlTmFtZXMnLFxuICAgICdtb2RlJ1xuICBdKTtcblxuICBwcm94eU1ldGhvZHMoVHJhbnNhY3Rpb24sICdfdHgnLCBJREJUcmFuc2FjdGlvbiwgW1xuICAgICdhYm9ydCdcbiAgXSk7XG5cbiAgZnVuY3Rpb24gVXBncmFkZURCKGRiLCBvbGRWZXJzaW9uLCB0cmFuc2FjdGlvbikge1xuICAgIHRoaXMuX2RiID0gZGI7XG4gICAgdGhpcy5vbGRWZXJzaW9uID0gb2xkVmVyc2lvbjtcbiAgICB0aGlzLnRyYW5zYWN0aW9uID0gbmV3IFRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uKTtcbiAgfVxuXG4gIFVwZ3JhZGVEQi5wcm90b3R5cGUuY3JlYXRlT2JqZWN0U3RvcmUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbmV3IE9iamVjdFN0b3JlKHRoaXMuX2RiLmNyZWF0ZU9iamVjdFN0b3JlLmFwcGx5KHRoaXMuX2RiLCBhcmd1bWVudHMpKTtcbiAgfTtcblxuICBwcm94eVByb3BlcnRpZXMoVXBncmFkZURCLCAnX2RiJywgW1xuICAgICduYW1lJyxcbiAgICAndmVyc2lvbicsXG4gICAgJ29iamVjdFN0b3JlTmFtZXMnXG4gIF0pO1xuXG4gIHByb3h5TWV0aG9kcyhVcGdyYWRlREIsICdfZGInLCBJREJEYXRhYmFzZSwgW1xuICAgICdkZWxldGVPYmplY3RTdG9yZScsXG4gICAgJ2Nsb3NlJ1xuICBdKTtcblxuICBmdW5jdGlvbiBEQihkYikge1xuICAgIHRoaXMuX2RiID0gZGI7XG4gIH1cblxuICBEQi5wcm90b3R5cGUudHJhbnNhY3Rpb24gPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbmV3IFRyYW5zYWN0aW9uKHRoaXMuX2RiLnRyYW5zYWN0aW9uLmFwcGx5KHRoaXMuX2RiLCBhcmd1bWVudHMpKTtcbiAgfTtcblxuICBwcm94eVByb3BlcnRpZXMoREIsICdfZGInLCBbXG4gICAgJ25hbWUnLFxuICAgICd2ZXJzaW9uJyxcbiAgICAnb2JqZWN0U3RvcmVOYW1lcydcbiAgXSk7XG5cbiAgcHJveHlNZXRob2RzKERCLCAnX2RiJywgSURCRGF0YWJhc2UsIFtcbiAgICAnY2xvc2UnXG4gIF0pO1xuXG4gIC8vIEFkZCBjdXJzb3IgaXRlcmF0b3JzXG4gIC8vIFRPRE86IHJlbW92ZSB0aGlzIG9uY2UgYnJvd3NlcnMgZG8gdGhlIHJpZ2h0IHRoaW5nIHdpdGggcHJvbWlzZXNcbiAgWydvcGVuQ3Vyc29yJywgJ29wZW5LZXlDdXJzb3InXS5mb3JFYWNoKGZ1bmN0aW9uKGZ1bmNOYW1lKSB7XG4gICAgW09iamVjdFN0b3JlLCBJbmRleF0uZm9yRWFjaChmdW5jdGlvbihDb25zdHJ1Y3Rvcikge1xuICAgICAgQ29uc3RydWN0b3IucHJvdG90eXBlW2Z1bmNOYW1lLnJlcGxhY2UoJ29wZW4nLCAnaXRlcmF0ZScpXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgYXJncyA9IHRvQXJyYXkoYXJndW1lbnRzKTtcbiAgICAgICAgdmFyIGNhbGxiYWNrID0gYXJnc1thcmdzLmxlbmd0aCAtIDFdO1xuICAgICAgICB2YXIgbmF0aXZlT2JqZWN0ID0gdGhpcy5fc3RvcmUgfHwgdGhpcy5faW5kZXg7XG4gICAgICAgIHZhciByZXF1ZXN0ID0gbmF0aXZlT2JqZWN0W2Z1bmNOYW1lXS5hcHBseShuYXRpdmVPYmplY3QsIGFyZ3Muc2xpY2UoMCwgLTEpKTtcbiAgICAgICAgcmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICBjYWxsYmFjayhyZXF1ZXN0LnJlc3VsdCk7XG4gICAgICAgIH07XG4gICAgICB9O1xuICAgIH0pO1xuICB9KTtcblxuICAvLyBwb2x5ZmlsbCBnZXRBbGxcbiAgW0luZGV4LCBPYmplY3RTdG9yZV0uZm9yRWFjaChmdW5jdGlvbihDb25zdHJ1Y3Rvcikge1xuICAgIGlmIChDb25zdHJ1Y3Rvci5wcm90b3R5cGUuZ2V0QWxsKSByZXR1cm47XG4gICAgQ29uc3RydWN0b3IucHJvdG90eXBlLmdldEFsbCA9IGZ1bmN0aW9uKHF1ZXJ5LCBjb3VudCkge1xuICAgICAgdmFyIGluc3RhbmNlID0gdGhpcztcbiAgICAgIHZhciBpdGVtcyA9IFtdO1xuXG4gICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSkge1xuICAgICAgICBpbnN0YW5jZS5pdGVyYXRlQ3Vyc29yKHF1ZXJ5LCBmdW5jdGlvbihjdXJzb3IpIHtcbiAgICAgICAgICBpZiAoIWN1cnNvcikge1xuICAgICAgICAgICAgcmVzb2x2ZShpdGVtcyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIGl0ZW1zLnB1c2goY3Vyc29yLnZhbHVlKTtcblxuICAgICAgICAgIGlmIChjb3VudCAhPT0gdW5kZWZpbmVkICYmIGl0ZW1zLmxlbmd0aCA9PSBjb3VudCkge1xuICAgICAgICAgICAgcmVzb2x2ZShpdGVtcyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIGN1cnNvci5jb250aW51ZSgpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH07XG4gIH0pO1xuXG4gIHZhciBleHAgPSB7XG4gICAgb3BlbjogZnVuY3Rpb24obmFtZSwgdmVyc2lvbiwgdXBncmFkZUNhbGxiYWNrKSB7XG4gICAgICB2YXIgcCA9IHByb21pc2lmeVJlcXVlc3RDYWxsKGluZGV4ZWREQiwgJ29wZW4nLCBbbmFtZSwgdmVyc2lvbl0pO1xuICAgICAgdmFyIHJlcXVlc3QgPSBwLnJlcXVlc3Q7XG5cbiAgICAgIHJlcXVlc3Qub251cGdyYWRlbmVlZGVkID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgaWYgKHVwZ3JhZGVDYWxsYmFjaykge1xuICAgICAgICAgIHVwZ3JhZGVDYWxsYmFjayhuZXcgVXBncmFkZURCKHJlcXVlc3QucmVzdWx0LCBldmVudC5vbGRWZXJzaW9uLCByZXF1ZXN0LnRyYW5zYWN0aW9uKSk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIHJldHVybiBwLnRoZW4oZnVuY3Rpb24oZGIpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBEQihkYik7XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGRlbGV0ZTogZnVuY3Rpb24obmFtZSkge1xuICAgICAgcmV0dXJuIHByb21pc2lmeVJlcXVlc3RDYWxsKGluZGV4ZWREQiwgJ2RlbGV0ZURhdGFiYXNlJywgW25hbWVdKTtcbiAgICB9XG4gIH07XG5cbiAgaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBleHA7XG4gICAgbW9kdWxlLmV4cG9ydHMuZGVmYXVsdCA9IG1vZHVsZS5leHBvcnRzO1xuICB9XG4gIGVsc2Uge1xuICAgIHNlbGYuaWRiID0gZXhwO1xuICB9XG59KCkpO1xuIiwiaW1wb3J0IERCSGVscGVyIGZyb20gJy4vZGJoZWxwZXIuanMnO1xyXG5cclxubGV0IHJlc3RhdXJhbnQ7XHJcbnZhciBtYXA7XHJcbmNvbnN0IGltYWdlU291cmNlcyA9IFtcclxuICAgIHtcclxuICAgICAgICBzdWZmaXg6ICdfc20nLFxyXG4gICAgICAgIG1lZGlhOiAnKG1heC13aWR0aDogNDQwcHgpJ1xyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBzdWZmaXg6ICdfbWQnLFxyXG4gICAgICAgIG1lZGlhOiAnKG1heC13aWR0aDogNjQwcHgpLChtaW4td2lkdGg6IDExMDFweCkgYW5kIChtYXgtd2lkdGg6IDEyODBweCknXHJcbiAgICB9XHJcbl07XHJcblxyXG4vKipcclxuICogSW5pdGlhbGl6ZSBHb29nbGUgbWFwLCBjYWxsZWQgZnJvbSBIVE1MLlxyXG4gKi9cclxud2luZG93LmluaXRNYXAgPSAoKSA9PiB7XHJcbiAgICBmZXRjaFJlc3RhdXJhbnRGcm9tVVJMKChlcnJvciwgcmVzdGF1cmFudCkgPT4ge1xyXG4gICAgICAgIGlmIChlcnJvcikgeyAvLyBHb3QgYW4gZXJyb3IhXHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHNlbGYubWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwJyksIHtcclxuICAgICAgICAgICAgICAgIHpvb206IDE2LFxyXG4gICAgICAgICAgICAgICAgY2VudGVyOiByZXN0YXVyYW50LmxhdGxuZyxcclxuICAgICAgICAgICAgICAgIHNjcm9sbHdoZWVsOiBmYWxzZVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgZmlsbEJyZWFkY3J1bWIoKTtcclxuICAgICAgICAgICAgREJIZWxwZXIubWFwTWFya2VyRm9yUmVzdGF1cmFudChzZWxmLnJlc3RhdXJhbnQsIHNlbGYubWFwKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBHZXQgY3VycmVudCByZXN0YXVyYW50IGZyb20gcGFnZSBVUkwuXHJcbiAqL1xyXG5sZXQgZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCA9IChjYWxsYmFjaykgPT4ge1xyXG4gICAgaWYgKHNlbGYucmVzdGF1cmFudCkgeyAvLyByZXN0YXVyYW50IGFscmVhZHkgZmV0Y2hlZCFcclxuICAgICAgICBjYWxsYmFjayhudWxsLCBzZWxmLnJlc3RhdXJhbnQpXHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgaWQgPSBnZXRQYXJhbWV0ZXJCeU5hbWUoJ2lkJyk7XHJcbiAgICBpZiAoIWlkKSB7IC8vIG5vIGlkIGZvdW5kIGluIFVSTFxyXG4gICAgICAgIGVycm9yID0gJ05vIHJlc3RhdXJhbnQgaWQgaW4gVVJMJ1xyXG4gICAgICAgIGNhbGxiYWNrKGVycm9yLCBudWxsKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50QnlJZChpZCwgKGVycm9yLCByZXN0YXVyYW50KSA9PiB7XHJcbiAgICAgICAgICAgIHNlbGYucmVzdGF1cmFudCA9IHJlc3RhdXJhbnQ7XHJcbiAgICAgICAgICAgIGlmICghcmVzdGF1cmFudCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZmlsbFJlc3RhdXJhbnRIVE1MKCk7XHJcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3RhdXJhbnQpXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn07XHJcblxyXG4vKipcclxuICogQ3JlYXRlIHJlc3RhdXJhbnQgSFRNTCBhbmQgYWRkIGl0IHRvIHRoZSB3ZWJwYWdlXHJcbiAqL1xyXG5sZXQgZmlsbFJlc3RhdXJhbnRIVE1MID0gKHJlc3RhdXJhbnQgPSBzZWxmLnJlc3RhdXJhbnQpID0+IHtcclxuICAgIGNvbnN0IG5hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1uYW1lJyk7XHJcbiAgICBuYW1lLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZTtcclxuXHJcbiAgICBjb25zdCBhZGRyZXNzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtYWRkcmVzcycpO1xyXG4gICAgYWRkcmVzcy5pbm5lckhUTUwgPSByZXN0YXVyYW50LmFkZHJlc3M7XHJcblxyXG4gICAgY29uc3QgaW1hZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1pbWcnKTtcclxuICAgIGltYWdlLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LWltZyc7XHJcbiAgICBpbWFnZS5zcmMgPSBEQkhlbHBlci5pbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudC5waG90b2dyYXBoKTtcclxuICAgIGltYWdlLmFsdCA9IGBJbWFnZSBvZiAke3Jlc3RhdXJhbnQubmFtZX0gUmVzdGF1cmFudGA7XHJcblxyXG4gICAgLy8gUmVzcG9uc2l2ZSBpbWFnZXNcclxuICAgIGNvbnN0IHBpY3R1cmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1waWN0dXJlJyk7XHJcbiAgICBjb25zdCBzb3VyY2VzID0gW107XHJcbiAgICBpbWFnZVNvdXJjZXMuZm9yRWFjaCgoaW1hZ2VTb3VyY2UpID0+IHtcclxuICAgICAgICBjb25zdCBzb3VyY2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzb3VyY2UnKTtcclxuICAgICAgICBzb3VyY2Uuc3Jjc2V0ID0gREJIZWxwZXIuaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQucGhvdG9ncmFwaCwgJy9yZXNwb25zaXZlLycsIGltYWdlU291cmNlLnN1ZmZpeCk7XHJcbiAgICAgICAgc291cmNlLm1lZGlhID0gaW1hZ2VTb3VyY2UubWVkaWE7XHJcbiAgICAgICAgc291cmNlcy5wdXNoKHNvdXJjZSk7XHJcbiAgICB9KTtcclxuICAgIHNvdXJjZXMuZm9yRWFjaCgoc291cmNlKSA9PiB7XHJcbiAgICAgICAgcGljdHVyZS5pbnNlcnRCZWZvcmUoc291cmNlLCBpbWFnZSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCBjdWlzaW5lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtY3Vpc2luZScpO1xyXG4gICAgY3Vpc2luZS5pbm5lckhUTUwgPSByZXN0YXVyYW50LmN1aXNpbmVfdHlwZTtcclxuXHJcbiAgICAvLyBmaWxsIG9wZXJhdGluZyBob3Vyc1xyXG4gICAgaWYgKHJlc3RhdXJhbnQub3BlcmF0aW5nX2hvdXJzKSB7XHJcbiAgICAgICAgZmlsbFJlc3RhdXJhbnRIb3Vyc0hUTUwoKTtcclxuICAgIH1cclxuICAgIC8vIGZpbGwgcmV2aWV3c1xyXG4gICAgZmlsbFJldmlld3NIVE1MKCk7XHJcbn07XHJcblxyXG4vKipcclxuICogQ3JlYXRlIHJlc3RhdXJhbnQgb3BlcmF0aW5nIGhvdXJzIEhUTUwgdGFibGUgYW5kIGFkZCBpdCB0byB0aGUgd2VicGFnZS5cclxuICovXHJcbmxldCBmaWxsUmVzdGF1cmFudEhvdXJzSFRNTCA9IChvcGVyYXRpbmdIb3VycyA9IHNlbGYucmVzdGF1cmFudC5vcGVyYXRpbmdfaG91cnMpID0+IHtcclxuICAgIGNvbnN0IGhvdXJzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtaG91cnMnKTtcclxuICAgIGZvciAobGV0IGtleSBpbiBvcGVyYXRpbmdIb3Vycykge1xyXG4gICAgICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7XHJcblxyXG4gICAgICAgIGNvbnN0IGRheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RkJyk7XHJcbiAgICAgICAgZGF5LmlubmVySFRNTCA9IGtleTtcclxuICAgICAgICBkYXkuc2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbFwiLCBcIk9wZW4gXCIgKyBrZXkpO1xyXG4gICAgICAgIHJvdy5hcHBlbmRDaGlsZChkYXkpO1xyXG5cclxuICAgICAgICBjb25zdCB0aW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKTtcclxuICAgICAgICB0aW1lLmlubmVySFRNTCA9IG9wZXJhdGluZ0hvdXJzW2tleV07XHJcbiAgICAgICAgdGltZS5zZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsXCIsIFwiT3BlbmluZyBob3VycyBcIiArIG9wZXJhdGluZ0hvdXJzW2tleV0pO1xyXG4gICAgICAgIHJvdy5hcHBlbmRDaGlsZCh0aW1lKTtcclxuXHJcbiAgICAgICAgaG91cnMuYXBwZW5kQ2hpbGQocm93KTtcclxuICAgIH1cclxufTtcclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgYWxsIHJldmlld3MgSFRNTCBhbmQgYWRkIHRoZW0gdG8gdGhlIHdlYnBhZ2UuXHJcbiAqL1xyXG5sZXQgZmlsbFJldmlld3NIVE1MID0gKHJldmlld3MgPSBzZWxmLnJlc3RhdXJhbnQucmV2aWV3cykgPT4ge1xyXG4gICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jldmlld3MtY29udGFpbmVyJyk7XHJcbiAgICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gzJyk7XHJcbiAgICB0aXRsZS5pbm5lckhUTUwgPSAnUmV2aWV3cyc7XHJcbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQodGl0bGUpO1xyXG5cclxuICAgIGlmICghcmV2aWV3cykge1xyXG4gICAgICAgIGNvbnN0IG5vUmV2aWV3cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcclxuICAgICAgICBub1Jldmlld3MuaW5uZXJIVE1MID0gJ05vIHJldmlld3MgeWV0ISc7XHJcbiAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKG5vUmV2aWV3cyk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmV2aWV3cy1saXN0Jyk7XHJcbiAgICByZXZpZXdzLmZvckVhY2goKHJldmlldywgaW5kZXgpID0+IHtcclxuICAgICAgICB1bC5hcHBlbmRDaGlsZChjcmVhdGVSZXZpZXdIVE1MKHJldmlldywgcmV2aWV3cy5sZW5ndGgsIGluZGV4KSk7XHJcbiAgICB9KTtcclxuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh1bCk7XHJcbn07XHJcblxyXG4vKipcclxuICogQ3JlYXRlIHJldmlldyBIVE1MIGFuZCBhZGQgaXQgdG8gdGhlIHdlYnBhZ2UuXHJcbiAqL1xyXG5sZXQgY3JlYXRlUmV2aWV3SFRNTCA9IChyZXZpZXcsIGxlbmd0aCwgaW5kZXgpID0+IHtcclxuICAgIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcclxuICAgIGxpLnNldEF0dHJpYnV0ZSgnYXJpYS1zZXRzaXplJywgbGVuZ3RoKTtcclxuICAgIGxpLnNldEF0dHJpYnV0ZSgnYXJpYS1wb3NpbnNldCcsIChOdW1iZXIoaW5kZXgpKzEpLnRvU3RyaW5nKCkpO1xyXG4gICAgY29uc3QgbmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcclxuICAgIG5hbWUuaW5uZXJIVE1MID0gcmV2aWV3Lm5hbWU7XHJcbiAgICBsaS5hcHBlbmRDaGlsZChuYW1lKTtcclxuXHJcbiAgICBjb25zdCBkYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xyXG4gICAgZGF0ZS5pbm5lckhUTUwgPSByZXZpZXcuZGF0ZTtcclxuICAgIGxpLmFwcGVuZENoaWxkKGRhdGUpO1xyXG5cclxuICAgIGNvbnN0IHJhdGluZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcclxuICAgIHJhdGluZy5pbm5lckhUTUwgPSBgUmF0aW5nOiAke3Jldmlldy5yYXRpbmd9YDtcclxuICAgIGxpLmFwcGVuZENoaWxkKHJhdGluZyk7XHJcblxyXG4gICAgY29uc3QgY29tbWVudHMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgICBjb21tZW50cy5pbm5lckhUTUwgPSByZXZpZXcuY29tbWVudHM7XHJcbiAgICBsaS5hcHBlbmRDaGlsZChjb21tZW50cyk7XHJcblxyXG4gICAgcmV0dXJuIGxpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIEFkZCByZXN0YXVyYW50IG5hbWUgdG8gdGhlIGJyZWFkY3J1bWIgbmF2aWdhdGlvbiBtZW51XHJcbiAqL1xyXG5sZXQgZmlsbEJyZWFkY3J1bWIgPSAocmVzdGF1cmFudCA9IHNlbGYucmVzdGF1cmFudCkgPT4ge1xyXG4gICAgY29uc3QgYnJlYWRjcnVtYiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdicmVhZGNydW1iJyk7XHJcbiAgICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XHJcbiAgICBsaS5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5hbWU7XHJcbiAgICBsaS5zZXRBdHRyaWJ1dGUoJ2FyaWEtY3VycmVudCcsICdwYWdlJyk7XHJcbiAgICBicmVhZGNydW1iLmFwcGVuZENoaWxkKGxpKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBHZXQgYSBwYXJhbWV0ZXIgYnkgbmFtZSBmcm9tIHBhZ2UgVVJMLlxyXG4gKi9cclxubGV0IGdldFBhcmFtZXRlckJ5TmFtZSA9IChuYW1lLCB1cmwpID0+IHtcclxuICAgIGlmICghdXJsKVxyXG4gICAgICAgIHVybCA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xyXG4gICAgbmFtZSA9IG5hbWUucmVwbGFjZSgvW1xcW1xcXV0vZywgJ1xcXFwkJicpO1xyXG4gICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGBbPyZdJHtuYW1lfSg9KFteJiNdKil8JnwjfCQpYCksXHJcbiAgICAgICAgcmVzdWx0cyA9IHJlZ2V4LmV4ZWModXJsKTtcclxuICAgIGlmICghcmVzdWx0cylcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIGlmICghcmVzdWx0c1syXSlcclxuICAgICAgICByZXR1cm4gJyc7XHJcbiAgICByZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KHJlc3VsdHNbMl0ucmVwbGFjZSgvXFwrL2csICcgJykpO1xyXG59O1xyXG4iXSwic291cmNlUm9vdCI6IiJ9